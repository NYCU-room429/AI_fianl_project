2025-05-30 18:34:09.711 | INFO     | __main__:main:387 - Using device: cuda
2025-05-30 18:34:09.712 | INFO     | __main__:main:391 - Configuration: {'torch': <module 'torch' from 'D:\\AI_fianl_project\\ai_final\\Lib\\site-packages\\torch\\__init__.py'>, 'os': <module 'os' (frozen)>, 'DEVICE': device(type='cuda'), 'NUM_WORKERS': 4, 'SLAKH_ROOT_DIR': 'D:\\\\AI_fianl_project\\\\slakh2100_flac_redux\\\\slakh2100_flac_redux', 'TRAIN_DIR_NAME': 'train', 'VALID_DIR_NAME': 'validation', 'TEST_DIR_NAME': 'test', 'CLASS_JSON_PATH': 'D:\\AI_fianl_project\\slakh-utils\\midi_inst_values\\general_midi_inst_0based.json', 'SAMPLE_RATE': 22050, 'SEGMENT_SEC': 10.0, 'N_MELS': 128, 'N_FFT': 2048, 'HOP_LENGTH': 220, 'NUM_SPECTROGRAM_FRAMES': 1003, 'SPECAUG_FREQ_MASKS': 2, 'SPECAUG_TIME_MASKS': 2, 'SPECAUG_FREQ_MAX_WIDTH': 20, 'SPECAUG_TIME_MAX_WIDTH': 100, 'MODEL_CNN_FILTERS': [64, 128, 256, 512], 'MODEL_RNN_UNITS': 256, 'MODEL_ATTENTION_HEADS': 4, 'MODEL_DROPOUT_RATE': 0.3, 'BATCH_SIZE': 12, 'LEARNING_RATE': 0.0001, 'WEIGHT_DECAY': 1e-05, 'EPOCHS': 50, 'GRAD_CLIP_NORM': 1.0, 'POS_WEIGHT_CLAMP_MIN': 1.0, 'POS_WEIGHT_CLAMP_MAX': 10.0, 'LR_SCHEDULER_PATIENCE': 5, 'LR_SCHEDULER_FACTOR': 0.5, 'EARLY_STOPPING_PATIENCE': 10, 'MODEL_SAVE_DIR': 'D:\\AI_fianl_project\\test_CRNN', 'MODEL_FILENAME': 'instr_recognizer_best.pth', 'THRESHOLDS_FILENAME': 'instr_recognizer_thresholds.npy', 'LOG_FILENAME': 'training_log.log', 'PLOT_FILENAME': 'training_plot.png', 'GUI_DISPLAY_PROB_THRESHOLD': 0.1, 'MIN_AUDIO_DURATION_SEC': 10.1}
2025-05-30 18:34:09.719 | INFO     | __main__:main:395 - Found 129 instrument classes.
2025-05-30 18:34:09.720 | INFO     | __main__:main:397 - Collecting training file paths...
2025-05-30 18:34:54.985 | INFO     | __main__:main:402 - Collecting validation file paths...
2025-05-30 18:35:03.854 | INFO     | data_loader:get_positive_weights:129 - Calculating positive weights for loss function...
2025-05-30 18:36:11.884 | INFO     | data_loader:get_positive_weights:172 - Calculated pos_weights: [10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0]
2025-05-30 18:42:48.032 | INFO     | __main__:main:387 - Using device: cuda
2025-05-30 18:42:48.032 | INFO     | __main__:main:391 - Configuration: {'torch': <module 'torch' from 'D:\\AI_fianl_project\\ai_final\\Lib\\site-packages\\torch\\__init__.py'>, 'os': <module 'os' (frozen)>, 'DEVICE': device(type='cuda'), 'NUM_WORKERS': 4, 'SLAKH_ROOT_DIR': 'D:\\\\AI_fianl_project\\\\slakh2100_flac_redux\\\\slakh2100_flac_redux', 'TRAIN_DIR_NAME': 'train', 'VALID_DIR_NAME': 'validation', 'TEST_DIR_NAME': 'test', 'CLASS_JSON_PATH': 'D:\\AI_fianl_project\\slakh-utils\\midi_inst_values\\general_midi_inst_0based.json', 'SAMPLE_RATE': 22050, 'SEGMENT_SEC': 10.0, 'N_MELS': 128, 'N_FFT': 2048, 'HOP_LENGTH': 220, 'NUM_SPECTROGRAM_FRAMES': 1003, 'SPECAUG_FREQ_MASKS': 2, 'SPECAUG_TIME_MASKS': 2, 'SPECAUG_FREQ_MAX_WIDTH': 20, 'SPECAUG_TIME_MAX_WIDTH': 100, 'MODEL_CNN_FILTERS': [64, 128, 256, 512], 'MODEL_RNN_UNITS': 256, 'MODEL_ATTENTION_HEADS': 4, 'MODEL_DROPOUT_RATE': 0.3, 'BATCH_SIZE': 12, 'LEARNING_RATE': 0.0001, 'WEIGHT_DECAY': 1e-05, 'EPOCHS': 50, 'GRAD_CLIP_NORM': 1.0, 'POS_WEIGHT_CLAMP_MIN': 1.0, 'POS_WEIGHT_CLAMP_MAX': 10.0, 'LR_SCHEDULER_PATIENCE': 5, 'LR_SCHEDULER_FACTOR': 0.5, 'EARLY_STOPPING_PATIENCE': 10, 'MODEL_SAVE_DIR': 'D:\\AI_fianl_project\\test_CRNN', 'MODEL_FILENAME': 'instr_recognizer_best.pth', 'THRESHOLDS_FILENAME': 'instr_recognizer_thresholds.npy', 'LOG_FILENAME': 'training_log.log', 'PLOT_FILENAME': 'training_plot.png', 'GUI_DISPLAY_PROB_THRESHOLD': 0.1, 'MIN_AUDIO_DURATION_SEC': 10.1}
2025-05-30 18:42:48.033 | INFO     | __main__:main:395 - Found 129 instrument classes.
2025-05-30 18:42:48.033 | INFO     | __main__:main:397 - Collecting training file paths...
2025-05-30 18:43:02.954 | INFO     | __main__:main:402 - Collecting validation file paths...
2025-05-30 18:43:05.793 | INFO     | data_loader:get_positive_weights:129 - Calculating positive weights for loss function...
2025-05-30 18:44:07.850 | INFO     | data_loader:get_positive_weights:172 - Calculated pos_weights: [10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0, 10.0]
2025-05-30 18:44:08.463 | INFO     | __main__:main:428 - Model initialized with 13,676,355 trainable parameters.
2025-05-30 18:44:09.740 | INFO     | __main__:main:439 - --- Starting Training for 50 Epochs ---
2025-05-30 18:44:09.741 | INFO     | __main__:main:441 - Epoch 1/50 | LR: 1.00e-04
2025-05-30 19:02:08.435 | INFO     | __main__:main:445 - Epoch 1 Avg Train Loss: 0.1230
2025-05-30 19:06:02.548 | INFO     | __main__:main:452 - Epoch 1 Val Loss: 0.1197 | Val Micro-F1: 0.1708 | Val Macro-F1: 0.0749
2025-05-30 19:06:02.635 | INFO     | __main__:main:462 - *** Best Model Saved! Val Macro F1 improved to 0.0749 ***
2025-05-30 19:06:02.636 | INFO     | __main__:main:441 - Epoch 2/50 | LR: 1.00e-04
2025-05-30 19:18:54.067 | INFO     | __main__:main:445 - Epoch 2 Avg Train Loss: 0.0896
2025-05-30 19:22:43.766 | INFO     | __main__:main:452 - Epoch 2 Val Loss: 0.0897 | Val Micro-F1: 0.1881 | Val Macro-F1: 0.1051
2025-05-30 19:22:43.854 | INFO     | __main__:main:462 - *** Best Model Saved! Val Macro F1 improved to 0.1051 ***
2025-05-30 19:22:43.855 | INFO     | __main__:main:441 - Epoch 3/50 | LR: 1.00e-04
2025-05-30 19:35:36.813 | INFO     | __main__:main:445 - Epoch 3 Avg Train Loss: 0.0814
2025-05-30 19:39:25.797 | INFO     | __main__:main:452 - Epoch 3 Val Loss: 0.0801 | Val Micro-F1: 0.2114 | Val Macro-F1: 0.1172
2025-05-30 19:39:25.881 | INFO     | __main__:main:462 - *** Best Model Saved! Val Macro F1 improved to 0.1172 ***
2025-05-30 19:39:25.881 | INFO     | __main__:main:441 - Epoch 4/50 | LR: 1.00e-04
