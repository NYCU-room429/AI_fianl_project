2025-05-30 21:14:35.071 | INFO     | __main__:evaluate_model:201 - --- Starting Evaluation on Test Set ---
2025-05-30 21:14:35.071 | INFO     | __main__:evaluate_model:202 - Loading test data from: D:\\AI_fianl_project\\slakh2100_flac_redux\\slakh2100_flac_redux\test
2025-05-30 21:14:35.883 | INFO     | __main__:evaluate_model:223 - Loaded 151 test samples in 13 batches.
2025-05-30 21:14:35.883 | INFO     | __main__:evaluate_model:226 - Loading model from: D:\AI_fianl_project\test_CRNN\instr_recognizer_best.pth
2025-05-30 21:14:36.142 | INFO     | __main__:evaluate_model:250 - Loaded thresholds from D:\AI_fianl_project\test_CRNN\instr_recognizer_thresholds.npy. Using them as is for evaluation.
2025-05-30 21:14:36.142 | INFO     | __main__:evaluate_model:257 - Running model on test set...
2025-05-30 21:15:00.579 | INFO     | __main__:evaluate_model:278 - --- Frame-level Evaluation Metrics ---
2025-05-30 21:15:02.795 | INFO     | __main__:evaluate_model:284 - Micro Precision: 0.0826
2025-05-30 21:15:02.795 | INFO     | __main__:evaluate_model:285 - Micro Recall:    0.5808
2025-05-30 21:15:02.796 | INFO     | __main__:evaluate_model:286 - Micro F1-score:  0.1447
2025-05-30 21:15:04.973 | INFO     | __main__:evaluate_model:292 - Macro Precision: 0.0596
2025-05-30 21:15:04.973 | INFO     | __main__:evaluate_model:293 - Macro Recall:    0.2503
2025-05-30 21:15:04.973 | INFO     | __main__:evaluate_model:294 - Macro F1-score:  0.0648
2025-05-30 21:15:05.685 | INFO     | __main__:evaluate_model:298 - Weighted F1-score: 0.3192
2025-05-30 21:15:11.050 | INFO     | __main__:evaluate_model:305 - ROC AUC (Micro): 0.8873
2025-05-30 21:15:11.050 | INFO     | __main__:evaluate_model:306 - ROC AUC (Macro): nan
2025-05-30 21:15:16.729 | INFO     | __main__:evaluate_model:314 - PR AUC (Micro - Avg Precision): 0.2660
2025-05-30 21:15:16.730 | INFO     | __main__:evaluate_model:315 - PR AUC (Macro - Avg Precision): 0.0684
2025-05-30 21:15:16.730 | INFO     | __main__:evaluate_model:320 - 
--- Per-class F1-scores (using loaded thresholds) ---
2025-05-30 21:15:17.440 | INFO     | __main__:evaluate_model:325 -   - Accordion                : F1=0.1249 (Support: 3976)
2025-05-30 21:15:17.441 | INFO     | __main__:evaluate_model:325 -   - Acoustic Bass            : F1=0.0473 (Support: 3756)
2025-05-30 21:15:17.442 | INFO     | __main__:evaluate_model:325 -   - Acoustic Grand Piano     : F1=0.2764 (Support: 21205)
2025-05-30 21:15:17.443 | INFO     | __main__:evaluate_model:325 -   - Acoustic Guitar (nylon)  : F1=0.3992 (Support: 15939)
2025-05-30 21:15:17.443 | INFO     | __main__:evaluate_model:325 -   - Acoustic Guitar (steel)  : F1=0.5506 (Support: 51712)
2025-05-30 21:15:17.444 | INFO     | __main__:evaluate_model:325 -   - Agogo                    : F1=0.0000 (Support: 0)
2025-05-30 21:15:17.444 | INFO     | __main__:evaluate_model:325 -   - Alto Sax                 : F1=0.0000 (Support: 8057)
2025-05-30 21:15:17.445 | INFO     | __main__:evaluate_model:325 -   - Applause                 : F1=0.0000 (Support: 0)
2025-05-30 21:15:17.445 | INFO     | __main__:evaluate_model:325 -   - Bag pipe                 : F1=0.0000 (Support: 0)
2025-05-30 21:15:17.446 | INFO     | __main__:evaluate_model:325 -   - Banjo                    : F1=0.0000 (Support: 951)
2025-05-30 21:15:17.447 | INFO     | __main__:evaluate_model:325 -   - Baritone Sax             : F1=0.0000 (Support: 299)
2025-05-30 21:15:17.447 | INFO     | __main__:evaluate_model:325 -   - Bassoon                  : F1=0.0000 (Support: 0)
2025-05-30 21:15:17.449 | INFO     | __main__:evaluate_model:325 -   - Bird Tweet               : F1=0.0000 (Support: 0)
2025-05-30 21:15:17.450 | INFO     | __main__:evaluate_model:325 -   - Blown Bottle             : F1=0.0000 (Support: 0)
2025-05-30 21:15:17.451 | INFO     | __main__:evaluate_model:325 -   - Brass Section            : F1=0.0000 (Support: 7593)
2025-05-30 21:15:17.451 | INFO     | __main__:evaluate_model:325 -   - Breath Noise             : F1=0.0000 (Support: 0)
2025-05-30 21:15:17.452 | INFO     | __main__:evaluate_model:325 -   - Bright Acoustic Piano    : F1=0.3914 (Support: 38621)
2025-05-30 21:15:17.453 | INFO     | __main__:evaluate_model:325 -   - Celesta                  : F1=0.0094 (Support: 771)
2025-05-30 21:15:17.454 | INFO     | __main__:evaluate_model:325 -   - Cello                    : F1=0.0000 (Support: 0)
2025-05-30 21:15:17.454 | INFO     | __main__:evaluate_model:325 -   - Choir Aahs               : F1=0.1387 (Support: 11463)
2025-05-30 21:15:17.455 | INFO     | __main__:evaluate_model:325 -   - Church Organ             : F1=0.0000 (Support: 982)
2025-05-30 21:15:17.455 | INFO     | __main__:evaluate_model:325 -   - Clarinet                 : F1=0.0000 (Support: 4638)
2025-05-30 21:15:17.456 | INFO     | __main__:evaluate_model:325 -   - Clavinet                 : F1=0.2437 (Support: 3081)
2025-05-30 21:15:17.457 | INFO     | __main__:evaluate_model:325 -   - Contrabass               : F1=0.0000 (Support: 0)
2025-05-30 21:15:17.457 | INFO     | __main__:evaluate_model:325 -   - Distortion Guitar        : F1=0.1061 (Support: 16238)
2025-05-30 21:15:17.458 | INFO     | __main__:evaluate_model:325 -   - Drawbar Organ            : F1=0.0000 (Support: 4637)
2025-05-30 21:15:17.458 | INFO     | __main__:evaluate_model:325 -   - Drums                    : F1=0.4931 (Support: 49113)
2025-05-30 21:15:17.459 | INFO     | __main__:evaluate_model:325 -   - Dulcimer                 : F1=0.0000 (Support: 0)
2025-05-30 21:15:17.459 | INFO     | __main__:evaluate_model:325 -   - Electric Bass (finger)   : F1=0.5636 (Support: 56999)
2025-05-30 21:15:17.460 | INFO     | __main__:evaluate_model:325 -   - Electric Bass (pick)     : F1=0.0483 (Support: 3455)
2025-05-30 21:15:17.460 | INFO     | __main__:evaluate_model:325 -   - Electric Grand Piano     : F1=0.1001 (Support: 4617)
2025-05-30 21:15:17.460 | INFO     | __main__:evaluate_model:325 -   - Electric Guitar (clean)  : F1=0.3300 (Support: 26253)
2025-05-30 21:15:17.461 | INFO     | __main__:evaluate_model:325 -   - Electric Guitar (jazz)   : F1=0.2110 (Support: 18210)
2025-05-30 21:15:17.461 | INFO     | __main__:evaluate_model:325 -   - Electric Guitar (muted)  : F1=0.1884 (Support: 10724)
2025-05-30 21:15:17.461 | INFO     | __main__:evaluate_model:325 -   - Electric Piano 1         : F1=0.2342 (Support: 15866)
2025-05-30 21:15:17.462 | INFO     | __main__:evaluate_model:325 -   - Electric Piano 2         : F1=0.3692 (Support: 32085)
2025-05-30 21:15:17.463 | INFO     | __main__:evaluate_model:325 -   - English Horn             : F1=0.0008 (Support: 33)
2025-05-30 21:15:17.463 | INFO     | __main__:evaluate_model:325 -   - FX 1 (rain)              : F1=0.0000 (Support: 0)
2025-05-30 21:15:17.464 | INFO     | __main__:evaluate_model:325 -   - FX 2 (soundtrack)        : F1=0.0000 (Support: 0)
2025-05-30 21:15:17.464 | INFO     | __main__:evaluate_model:325 -   - FX 3 (crystal)           : F1=0.0000 (Support: 114)
2025-05-30 21:15:17.464 | INFO     | __main__:evaluate_model:325 -   - FX 4 (atmosphere)        : F1=0.0458 (Support: 2724)
2025-05-30 21:15:17.465 | INFO     | __main__:evaluate_model:325 -   - FX 5 (brightness)        : F1=0.0006 (Support: 1870)
2025-05-30 21:15:17.465 | INFO     | __main__:evaluate_model:325 -   - FX 6 (goblins)           : F1=0.0000 (Support: 0)
2025-05-30 21:15:17.466 | INFO     | __main__:evaluate_model:325 -   - FX 7 (echoes)            : F1=0.0028 (Support: 399)
2025-05-30 21:15:17.466 | INFO     | __main__:evaluate_model:325 -   - FX 8 (sci-fi)            : F1=0.0000 (Support: 78)
2025-05-30 21:15:17.466 | INFO     | __main__:evaluate_model:325 -   - Fiddle                   : F1=0.0107 (Support: 771)
2025-05-30 21:15:17.467 | INFO     | __main__:evaluate_model:325 -   - Flute                    : F1=0.0000 (Support: 7179)
2025-05-30 21:15:17.467 | INFO     | __main__:evaluate_model:325 -   - French Horn              : F1=0.0000 (Support: 772)
2025-05-30 21:15:17.468 | INFO     | __main__:evaluate_model:325 -   - Fretless Bass            : F1=0.4849 (Support: 54314)
2025-05-30 21:15:17.468 | INFO     | __main__:evaluate_model:325 -   - Glockenspiel             : F1=0.0080 (Support: 561)
2025-05-30 21:15:17.468 | INFO     | __main__:evaluate_model:325 -   - Guitar Fret Noise        : F1=0.0000 (Support: 44)
2025-05-30 21:15:17.469 | INFO     | __main__:evaluate_model:325 -   - Guitar harmonics         : F1=0.0000 (Support: 0)
2025-05-30 21:15:17.469 | INFO     | __main__:evaluate_model:325 -   - Gunshot                  : F1=0.0000 (Support: 0)
2025-05-30 21:15:17.470 | INFO     | __main__:evaluate_model:325 -   - Harmonica                : F1=0.0000 (Support: 5131)
2025-05-30 21:15:17.470 | INFO     | __main__:evaluate_model:325 -   - Harpsichord              : F1=0.0520 (Support: 3614)
2025-05-30 21:15:17.471 | INFO     | __main__:evaluate_model:325 -   - Helicopter               : F1=0.0000 (Support: 0)
2025-05-30 21:15:17.472 | INFO     | __main__:evaluate_model:325 -   - Honky-tonk Piano         : F1=0.0000 (Support: 4200)
2025-05-30 21:15:17.472 | INFO     | __main__:evaluate_model:325 -   - Kalimba                  : F1=0.0000 (Support: 656)
2025-05-30 21:15:17.473 | INFO     | __main__:evaluate_model:325 -   - Koto                     : F1=0.0000 (Support: 0)
2025-05-30 21:15:17.474 | INFO     | __main__:evaluate_model:325 -   - Lead 1 (square)          : F1=0.0000 (Support: 315)
2025-05-30 21:15:17.474 | INFO     | __main__:evaluate_model:325 -   - Lead 2 (sawtooth)        : F1=0.2047 (Support: 4008)
2025-05-30 21:15:17.475 | INFO     | __main__:evaluate_model:325 -   - Lead 3 (calliope)        : F1=0.0089 (Support: 3136)
2025-05-30 21:15:17.475 | INFO     | __main__:evaluate_model:325 -   - Lead 4 (chiff)           : F1=0.0000 (Support: 0)
2025-05-30 21:15:17.476 | INFO     | __main__:evaluate_model:325 -   - Lead 5 (charang)         : F1=0.0059 (Support: 418)
2025-05-30 21:15:17.476 | INFO     | __main__:evaluate_model:325 -   - Lead 6 (voice)           : F1=0.0079 (Support: 518)
2025-05-30 21:15:17.477 | INFO     | __main__:evaluate_model:325 -   - Lead 7 (fifths)          : F1=0.0000 (Support: 0)
2025-05-30 21:15:17.477 | INFO     | __main__:evaluate_model:325 -   - Lead 8 (bass + lead)     : F1=0.0000 (Support: 3541)
2025-05-30 21:15:17.478 | INFO     | __main__:evaluate_model:325 -   - Marimba                  : F1=0.0000 (Support: 322)
2025-05-30 21:15:17.478 | INFO     | __main__:evaluate_model:325 -   - Melodic Tom              : F1=0.0000 (Support: 29)
2025-05-30 21:15:17.479 | INFO     | __main__:evaluate_model:325 -   - Music Box                : F1=0.0000 (Support: 0)
2025-05-30 21:15:17.479 | INFO     | __main__:evaluate_model:325 -   - Muted Trumpet            : F1=0.0000 (Support: 0)
2025-05-30 21:15:17.479 | INFO     | __main__:evaluate_model:325 -   - Oboe                     : F1=0.0000 (Support: 2457)
2025-05-30 21:15:17.480 | INFO     | __main__:evaluate_model:325 -   - Ocarina                  : F1=0.0170 (Support: 1184)
2025-05-30 21:15:17.480 | INFO     | __main__:evaluate_model:325 -   - Orchestra Hit            : F1=0.0000 (Support: 0)
2025-05-30 21:15:17.481 | INFO     | __main__:evaluate_model:325 -   - Orchestral Harp          : F1=0.0011 (Support: 168)
2025-05-30 21:15:17.481 | INFO     | __main__:evaluate_model:325 -   - Overdriven Guitar        : F1=0.1790 (Support: 22149)
2025-05-30 21:15:17.481 | INFO     | __main__:evaluate_model:325 -   - Pad 1 (new age)          : F1=0.0354 (Support: 3199)
2025-05-30 21:15:17.482 | INFO     | __main__:evaluate_model:325 -   - Pad 2 (warm)             : F1=0.0049 (Support: 5657)
2025-05-30 21:15:17.482 | INFO     | __main__:evaluate_model:325 -   - Pad 3 (polysynth)        : F1=0.0435 (Support: 2149)
2025-05-30 21:15:17.483 | INFO     | __main__:evaluate_model:325 -   - Pad 4 (choir)            : F1=0.0000 (Support: 2492)
2025-05-30 21:15:17.483 | INFO     | __main__:evaluate_model:325 -   - Pad 5 (bowed)            : F1=0.0000 (Support: 1172)
2025-05-30 21:15:17.484 | INFO     | __main__:evaluate_model:325 -   - Pad 6 (metallic)         : F1=0.0288 (Support: 1718)
2025-05-30 21:15:17.484 | INFO     | __main__:evaluate_model:325 -   - Pad 7 (halo)             : F1=0.1034 (Support: 3356)
2025-05-30 21:15:17.485 | INFO     | __main__:evaluate_model:325 -   - Pad 8 (sweep)            : F1=0.0000 (Support: 0)
2025-05-30 21:15:17.485 | INFO     | __main__:evaluate_model:325 -   - Pan Flute                : F1=0.2283 (Support: 3652)
2025-05-30 21:15:17.485 | INFO     | __main__:evaluate_model:325 -   - Percussive Organ         : F1=0.1038 (Support: 7984)
2025-05-30 21:15:17.487 | INFO     | __main__:evaluate_model:325 -   - Piccolo                  : F1=0.0000 (Support: 276)
2025-05-30 21:15:17.487 | INFO     | __main__:evaluate_model:325 -   - Pizzicato Strings        : F1=0.0315 (Support: 989)
2025-05-30 21:15:17.488 | INFO     | __main__:evaluate_model:325 -   - Recorder                 : F1=0.0000 (Support: 0)
2025-05-30 21:15:17.488 | INFO     | __main__:evaluate_model:325 -   - Reed Organ               : F1=0.0000 (Support: 0)
2025-05-30 21:15:17.489 | INFO     | __main__:evaluate_model:325 -   - Reverse Cymbal           : F1=0.0017 (Support: 93)
2025-05-30 21:15:17.490 | INFO     | __main__:evaluate_model:325 -   - Rock Organ               : F1=0.1394 (Support: 6167)
2025-05-30 21:15:17.490 | INFO     | __main__:evaluate_model:325 -   - Seashore                 : F1=0.0000 (Support: 0)
2025-05-30 21:15:17.491 | INFO     | __main__:evaluate_model:325 -   - Shakuhachi               : F1=0.0347 (Support: 1720)
2025-05-30 21:15:17.491 | INFO     | __main__:evaluate_model:325 -   - Shamisen                 : F1=0.0002 (Support: 1003)
2025-05-30 21:15:17.492 | INFO     | __main__:evaluate_model:325 -   - Shanai                   : F1=0.0000 (Support: 0)
2025-05-30 21:15:17.492 | INFO     | __main__:evaluate_model:325 -   - Sitar                    : F1=0.0000 (Support: 998)
2025-05-30 21:15:17.493 | INFO     | __main__:evaluate_model:325 -   - Slap Bass 1              : F1=0.0175 (Support: 1222)
2025-05-30 21:15:17.493 | INFO     | __main__:evaluate_model:325 -   - Slap Bass 2              : F1=0.0239 (Support: 945)
2025-05-30 21:15:17.494 | INFO     | __main__:evaluate_model:325 -   - Soprano Sax              : F1=0.0094 (Support: 611)
2025-05-30 21:15:17.494 | INFO     | __main__:evaluate_model:325 -   - Steel Drums              : F1=0.0000 (Support: 491)
2025-05-30 21:15:17.495 | INFO     | __main__:evaluate_model:325 -   - String Ensemble 1        : F1=0.5364 (Support: 45947)
2025-05-30 21:15:17.495 | INFO     | __main__:evaluate_model:325 -   - String Ensemble 2        : F1=0.4563 (Support: 28129)
2025-05-30 21:15:17.495 | INFO     | __main__:evaluate_model:325 -   - Synth Bass 1             : F1=0.0252 (Support: 2077)
2025-05-30 21:15:17.496 | INFO     | __main__:evaluate_model:325 -   - Synth Bass 2             : F1=0.0657 (Support: 5881)
2025-05-30 21:15:17.496 | INFO     | __main__:evaluate_model:325 -   - Synth Brass 1            : F1=0.0067 (Support: 242)
2025-05-30 21:15:17.497 | INFO     | __main__:evaluate_model:325 -   - Synth Brass 2            : F1=0.0000 (Support: 1599)
2025-05-30 21:15:17.497 | INFO     | __main__:evaluate_model:325 -   - Synth Drum               : F1=0.0000 (Support: 0)
2025-05-30 21:15:17.497 | INFO     | __main__:evaluate_model:325 -   - Synth Strings 1          : F1=0.2697 (Support: 13326)
2025-05-30 21:15:17.498 | INFO     | __main__:evaluate_model:325 -   - Synth Strings 2          : F1=0.0587 (Support: 3935)
2025-05-30 21:15:17.498 | INFO     | __main__:evaluate_model:325 -   - Synth Voice              : F1=0.0000 (Support: 0)
2025-05-30 21:15:17.499 | INFO     | __main__:evaluate_model:325 -   - Taiko Drum               : F1=0.0000 (Support: 0)
2025-05-30 21:15:17.499 | INFO     | __main__:evaluate_model:325 -   - Tango Accordion          : F1=0.0000 (Support: 409)
2025-05-30 21:15:17.499 | INFO     | __main__:evaluate_model:325 -   - Telephone Ring           : F1=0.0000 (Support: 0)
2025-05-30 21:15:17.500 | INFO     | __main__:evaluate_model:325 -   - Tenor Sax                : F1=0.0018 (Support: 2997)
2025-05-30 21:15:17.500 | INFO     | __main__:evaluate_model:325 -   - Timpani                  : F1=0.0000 (Support: 0)
2025-05-30 21:15:17.501 | INFO     | __main__:evaluate_model:325 -   - Tinkle Bell              : F1=0.0000 (Support: 0)
2025-05-30 21:15:17.501 | INFO     | __main__:evaluate_model:325 -   - Tremolo Strings          : F1=0.0097 (Support: 1177)
2025-05-30 21:15:17.501 | INFO     | __main__:evaluate_model:325 -   - Trombone                 : F1=0.0000 (Support: 4699)
2025-05-30 21:15:17.502 | INFO     | __main__:evaluate_model:325 -   - Trumpet                  : F1=0.0000 (Support: 3527)
2025-05-30 21:15:17.502 | INFO     | __main__:evaluate_model:325 -   - Tuba                     : F1=0.0534 (Support: 807)
2025-05-30 21:15:17.502 | INFO     | __main__:evaluate_model:325 -   - Tubular Bells            : F1=0.0000 (Support: 0)
2025-05-30 21:15:17.503 | INFO     | __main__:evaluate_model:325 -   - Vibraphone               : F1=0.1372 (Support: 6185)
2025-05-30 21:15:17.503 | INFO     | __main__:evaluate_model:325 -   - Viola                    : F1=0.0000 (Support: 758)
2025-05-30 21:15:17.504 | INFO     | __main__:evaluate_model:325 -   - Violin                   : F1=0.0324 (Support: 1002)
2025-05-30 21:15:17.504 | INFO     | __main__:evaluate_model:325 -   - Voice Oohs               : F1=0.0325 (Support: 3680)
2025-05-30 21:15:17.505 | INFO     | __main__:evaluate_model:325 -   - Whistle                  : F1=0.0014 (Support: 48)
2025-05-30 21:15:17.505 | INFO     | __main__:evaluate_model:325 -   - Woodblock                : F1=0.0000 (Support: 625)
2025-05-30 21:15:17.506 | INFO     | __main__:evaluate_model:325 -   - Xylophone                : F1=0.0107 (Support: 739)
2025-05-30 21:15:17.506 | INFO     | __main__:evaluate_model:327 - --- Evaluation Finished ---
